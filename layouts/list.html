{{ define "main" }}
  <section class="space-y-6">
    <h1 class="text-4xl font-bold tracking-tight text-center">
      {{ .Title }}
    </h1>

    {{ with .Content }}
      <div class="prose prose-invert max-w-none text-center">
        {{ . }}
      </div>
    {{ end }}
  </section>

  {{ $pages := .Pages.ByDate.Reverse }}
  {{ $p := .Paginate $pages }}


  <ul role="list" class="space-y-6">
    {{ range $p.Pages }}
      <li>
        <article
          class="rounded-xl border border-white/10 bg-white/5 p-5 sm:p-6 transition hover:bg-white/10 focus-within:ring-2 focus-within:ring-blue-500/60"
        >
          <header
            class="flex flex-col gap-1 sm:flex-row sm:items-baseline sm:justify-between"
          >
            <h2 class="text-lg sm:text-xl font-semibold leading-snug">
              <a
                class="text-white underline-offset-4 hover:underline focus:outline-none"
                href="{{ .RelPermalink }}"
              >
                {{ .LinkTitle }}
              </a>
            </h2>

            <p class="text-sm text-slate-300">
              <time datetime="{{ .Date.Format " 2006-01-02T15:04:05Z07:00" }}">
                {{ .Date.Format "Jan 2, 2006" }}
              </time>
            </p>
          </header>

          {{/* Prefer explicit summary, fall back to auto-summary */}}
          {{ $summary := "" }}
          {{ with .Params.summary }}
            {{ $summary = . }}
          {{ else }}
            {{ $summary = (.Summary | plainify) }}
          {{ end }}

          {{ with $summary }}
            <p class="mt-3 text-slate-200 leading-relaxed">
              {{ . | htmlUnescape | truncate 200 }}
            </p>
          {{ end }}


          <footer
            class="mt-4 flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-300"
          >
            <span>{{ .ReadingTime }} min read</span>

            {{ with .Params.tags }}
              <span class="text-slate-500">•</span>
              <ul class="flex flex-wrap gap-2" aria-label="Tags">
                {{ range . }}
                  <li>
                    <a
                      class="rounded-full border border-white/10 bg-black/30 px-2 py-0.5 text-xs text-slate-200 hover:bg-white/10"
                      href="{{ (printf " /tags/%s/" (. | urlize)) | relURL }}"
                    >
                      {{ . }}
                    </a>
                  </li>
                {{ end }}
              </ul>
            {{ end }}
          </footer>
        </article>
      </li>
    {{ end }}
  </ul>

  {{ if gt $p.TotalPages 1 }}
    <nav
      class="mt-10 flex items-center justify-between gap-4 text-sm"
      aria-label="Pagination"
    >
      {{ if $p.HasPrev }}
        <a
          class="rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-slate-100 hover:bg-white/10"
          href="{{ $p.Prev.URL }}"
        >
          ← Newer
        </a>
      {{ else }}
        <span class="px-3 py-2 text-slate-500">← Newer</span>
      {{ end }}


      <span class="text-slate-300">
        Page {{ $p.PageNumber }} of
        {{ $p.TotalPages }}
      </span>

      {{ if $p.HasNext }}
        <a
          class="rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-slate-100 hover:bg-white/10"
          href="{{ $p.Next.URL }}"
        >
          Older →
        </a>
      {{ else }}
        <span class="px-3 py-2 text-slate-500">Older →</span>
      {{ end }}
    </nav>
  {{ end }}
{{ end }}
